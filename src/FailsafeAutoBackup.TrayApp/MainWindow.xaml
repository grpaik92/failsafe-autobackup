<Window x:Class="FailsafeAutoBackup.TrayApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:FailsafeAutoBackup.TrayApp"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        mc:Ignorable="d"
        Title="Failsafe AutoBackup" Height="500" Width="700"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <tb:TaskbarIcon x:Key="TrayIcon"
                        ToolTipText="Failsafe AutoBackup"
                        MenuActivation="RightClick"
                        TrayLeftMouseUp="TrayIcon_OnTrayLeftMouseUp">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Open Dashboard" Click="OpenDashboard_Click" FontWeight="Bold"/>
                    <Separator/>
                    <MenuItem Header="Restart Service" Click="RestartService_Click"/>
                    <MenuItem Header="Open Logs Folder" Click="OpenLogsFolder_Click"/>
                    <MenuItem Header="Open Backup Folder" Click="OpenBackupFolder_Click"/>
                    <Separator/>
                    <MenuItem Header="Settings" Click="Settings_Click"/>
                    <Separator/>
                    <MenuItem Header="Exit" Click="Exit_Click"/>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Failsafe AutoBackup Dashboard" FontSize="24" FontWeight="Bold"/>
            <TextBlock Text="Automatic document backup service" FontSize="12" Foreground="Gray" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Content -->
        <TabControl Grid.Row="1">
            <TabItem Header="Status">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Service Status -->
                    <Border Grid.Row="0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,10" CornerRadius="5">
                        <StackPanel>
                            <TextBlock Text="Service Status" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                            <StackPanel Orientation="Horizontal">
                                <Ellipse x:Name="StatusIndicator" Width="12" Height="12" Fill="Green" Margin="0,0,10,0"/>
                                <TextBlock x:Name="StatusText" Text="Running" FontWeight="Bold"/>
                            </StackPanel>
                            <TextBlock x:Name="LastHeartbeatText" Text="Last heartbeat: N/A" Margin="0,5,0,0" FontSize="12" Foreground="Gray"/>
                        </StackPanel>
                    </Border>

                    <!-- Statistics -->
                    <Border Grid.Row="1" BorderBrush="#CCCCCC" BorderThickness="1" Padding="15" Margin="0,0,0,10" CornerRadius="5">
                        <StackPanel>
                            <TextBlock Text="Statistics" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Active Documents" FontSize="12" Foreground="Gray"/>
                                    <TextBlock x:Name="ActiveDocumentsText" Text="0" FontSize="24" FontWeight="Bold"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="Total Backups" FontSize="12" Foreground="Gray"/>
                                    <TextBlock x:Name="TotalBackupsText" Text="0" FontSize="24" FontWeight="Bold"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Recent Activity -->
                    <TextBlock Grid.Row="2" Text="Recent Activity" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                    <Border Grid.Row="3" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" CornerRadius="5">
                        <ScrollViewer>
                            <TextBlock x:Name="ActivityLog" Text="No recent activity" TextWrapping="Wrap" FontFamily="Consolas" FontSize="11"/>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabItem>

            <TabItem Header="Settings">
                <Grid Margin="10">
                    <StackPanel>
                        <TextBlock Text="Backup Settings" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>
                        
                        <TextBlock Text="Backup Interval (minutes):" Margin="0,0,0,5"/>
                        <TextBox x:Name="BackupIntervalTextBox" Text="2" Margin="0,0,0,15"/>

                        <TextBlock Text="Backup Folder Path:" Margin="0,0,0,5"/>
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="BackupFolderTextBox" Grid.Column="0" Margin="0,0,10,0"/>
                            <Button Grid.Column="1" Content="Browse..." Click="BrowseBackupFolder_Click" Padding="10,5"/>
                        </Grid>

                        <CheckBox x:Name="EnableWordCheckBox" Content="Enable Microsoft Word Backup" IsChecked="True" Margin="0,0,0,10"/>
                        <CheckBox x:Name="EnablePdfCheckBox" Content="Enable PDF Backup" IsChecked="True" Margin="0,0,0,10"/>
                        <CheckBox x:Name="CreateShortcutCheckBox" Content="Create Desktop Shortcut" IsChecked="True" Margin="0,0,0,20"/>

                        <Button Content="Save Settings" Click="SaveSettings_Click" Padding="15,8" HorizontalAlignment="Left"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="About">
                <Grid Margin="10">
                    <StackPanel>
                        <TextBlock Text="Failsafe AutoBackup" FontSize="20" FontWeight="Bold" Margin="0,0,0,10"/>
                        <TextBlock Text="Version 1.0.0" FontSize="14" Margin="0,0,0,20"/>
                        <TextBlock Text="Automatic backup service for Microsoft Word and PDF documents." TextWrapping="Wrap" Margin="0,0,0,10"/>
                        <TextBlock Text="Features:" FontWeight="Bold" Margin="0,10,0,5"/>
                        <TextBlock Text="• Automatic backup every 2 minutes" Margin="10,0,0,3"/>
                        <TextBlock Text="• Support for saved and unsaved documents" Margin="10,0,0,3"/>
                        <TextBlock Text="• Microsoft Word and Adobe Acrobat support" Margin="10,0,0,3"/>
                        <TextBlock Text="• Resilient Windows Service architecture" Margin="10,0,0,3"/>
                        <TextBlock Text="• Desktop shortcut management" Margin="10,0,0,20"/>
                        <TextBlock Text="© 2025 Failsafe AutoBackup. All rights reserved." FontSize="12" Foreground="Gray"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Footer -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Minimize to Tray" Click="MinimizeToTray_Click" Padding="10,5" Margin="0,0,10,0"/>
            <Button Content="Close" Click="Close_Click" Padding="10,5"/>
        </StackPanel>
    </Grid>
</Window>

